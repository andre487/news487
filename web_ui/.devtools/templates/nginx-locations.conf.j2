root /var/www/{{ service_host }}/build;

location ~ firebase-messaging-sw\.js {
    add_header Cache-Control "public, max-age=1800, must-revalidate";
}

location ~ \.js$ {
    add_header Cache-Control "public, max-age=31104000, immutable";
}

location / {
    try_files $uri @common;
}

location @common {
    root /var/www/common;
    try_files $uri @handlers;
}

location @handlers {
    add_header Cache-Control "public, max-age=1800, must-revalidate";
    try_files /index.html =404;
}
